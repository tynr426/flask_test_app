<!DOCTYPE html>
<htm>
    <head>
        <title>客户列表页面</title>
        <$include templatename="Meta.html" />

        <!--主页面专用-->
        <script language="javascript" type="text/javascript" src="~/js/admin.js"></script>
    </head>

    <body>
        <!--内容-->
        <div class="content-area">
            <!--面包屑-->
            <div class="content-title">客户列表</div>
            <!--//面包屑-->
            <!--内容盒-->
            <div class="custom-area" id="scroll-box">
                <!--内盒-->
                <div class="custom-box" scrollarea="box">
                    <!--滚动用盒层-->
                    <div class="custom-scroll" scrollroom="box">

                        <div class="label-box" label-box="group1">
                            <div class="mc" label-limitarea="group1">
                                <div class="for select">
                                    <div class="extend-button">
                                        <div class="button expert-close">
                                            <a href="javascript:void(0);" onclick="frm.add({ title: '添加客户', formId: 'CustomerFormTemplate', action: 'insert', completed: $e.areas,completes:['Province','City','Area'], callback: null, width: 700, height: 420 });" class="btn">添加客户</a>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--表格组件-->
                        <div class="custom-table">
                            <!--表格内盒-->
                            <div class="form" id="customChangeTable">
                                <table border="0" cellspacing="0" cellpadding="0">
                                    <colgroup>
                                        <col style="width: 25px;" />
                                        <col style="width: auto;" />
                                        <col style="width: auto;" />
                                        <col style="width: 80px;" />
                                        <col style="width: 80px;" />
                                        <col style="width: 70px;" />
                                        <col style="width:50px;" />
                                    </colgroup>

                                    <thead>
                                        <tr>
                                            <td>
                                                <div><input type="checkbox" value="" name="" checkall="1" /></div>
                                            </td>
                                            <td><p class="name center">客户名称</p></td>
                                            <td><p class="name center">所在区</p></td>
                                            <td><p class="name center">优先级</p></td>
                                            <td><p class="name center">状态</p></td>
                                            <td><p class="name center">添加时间</p></td>
                                            <td><p class="name center">操作</p></td>
                                        </tr>
                                    </thead>

                                    <tbody id="pageBody"></tbody>
                                </table>
                            </div>
                            <!--//表格内盒-->
                            <!--通用分页-->
                            <div class="page" id="PageBarList"></div>
                            <!--//通用分页-->
                        </div>
                        <!--//表格组件-->
                    </div>
                    <!--//滚动用盒层-->
                </div>
                <!--//内盒-->
            </div>
            <!--//内容盒-->
        </div>
    </body>
</htm>

<script type="text/template" id="CustomerFormTemplate">
    <div class="custom-table">
        <div class="form">
            <table border="0" cellpadding="0" cellspacing="0" id="CustomerForm">
                <colgroup>
                    <col style="width: 100px;" />
                    <col style="width: auto;" />
                    <col style="width: 100px;" />
                    <col style="width: auto;" />
                </colgroup>

                <tbody>
                    <tr>
                        <th>
                            <p class="name">
                                <em class="red">*</em>客户名称：
                            </p>
                        </th>
                        <td colspan="3">
                            <div class="inputbox">
                                <input type="hidden" id="Id" name="Id" value="" />
                                <input type="text" id="Name" name="Name" value="" validate="isnull" maxlength="50" style="width:550px;" />
                            </div>
                        </td>>

                    </tr>

                    <tr>
                        <th>
                            <p class="name">
                                <em class="red">*</em>地区：
                            </p>
                        </th>
                        <td colspan="3">
                            <div class="selectbox">
                                <select id="Province" name="Province" onchange="" validate="isnull"></select>
                            </div>

                            <span class="tips"></span>

                            <div class="selectbox">
                                <select id="City" name="City" onchange="" validate="isnull">
                                    <option value='-1' selected="selected">请选择</option>
                                </select>
                            </div>

                            <span class="tips"></span>

                            <div class="selectbox">
                                <select id="Area" name="Area" validate="isnull">
                                    <option value='-1' selected="selected">请选择</option>
                                </select>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <p class="name">
                                详细地址：
                            </p>
                        </th>
                        <td colspan="3">
                            <div class="inputbox">
                                <input type="text" id="Address" name="Address" value="" maxlength="250" style="width:550px;" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <p class="name">
                                描述：
                            </p>
                        </th>
                        <td colspan="3">
                            <div class="inputbox">
                                <textarea id="Description" name="Description" value="" maxlength="250" style="width:550px;"></textarea>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <p class="name">
                                优先级：
                            </p>
                        </th>
                        <td>
                            <div class="inputbox">
                                <select id="Priority" name="Priority" style="width:80px;">
                                    <option value="1">高</option>
                                    <option value="2">中</option>
                                    <option value="3">低</option>
                                </select>
                            </div>
                        </td>
                        <th>
                            <p class="name">
                                状态：
                            </p>
                        </th>
                        <td>
                            <select id="Status" name="Status" style="width:80px;">
                                <option value="1">开启</option>
                                <option value="0">关闭</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <p class="name">
                                排序：
                            </p>
                        </th>
                        <td>
                            <div class="inputbox">
                                <input type="text" id="Reorder" name="Reorder" value="1" maxlength="250" />
                            </div>
                        </td>
                        <th>
                            <p class="name">
                                合作时间：
                            </p>
                        </th>
                        <td>
                            <div class="inputbox">
                                <input type="text" id="CooperateTime" name="CooperateTime" value="" readonly=readonly onclick="WdatePicker({ dateFmt: 'yyyy-MM-dd'});" maxlength="250" />
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <th>
                            <p class="name">
                                备注：
                            </p>
                        </th>
                        <td colspan="3">
                            <div class="inputbox">
                                <textarea id="Remark" name="Remark" style="width:550px;"></textarea>
                            </div>
                        </td>

                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</script>

<script type="text/template" id="bodyListTemplate">
    {@each _ as f,index}
    <tr>
        <td>
            <div class="string"><input type="checkbox" /></div>
        </td>
        <td><div class="string">${f.Name}</div></td>
        <td><div class="string">${f.Province}-${f.City}-${f.Area}</div></td>
        <td><div class="string">${f.Priority|formatArray,dict.priority}</div></td>
        <td>
            {@if f.Status==0}
            <div class="extend">
                <div class="target target-off">
                    <span onclick="frm.switchStatus(this, '${f.Id}', '${f.Status}', function () { var li = $e(this).parent('li'); if (li.hasClass('close')) { li.removeClass('close'); } else { li.addClass('close'); } });"></span>
                </div>
            </div>
            {@else if f.Status>0}
            <div class="extend">
                <div class="target target-on">
                    <span onclick="frm.switchStatus(this, '${f.Id}', '${f.Status}', function () { var li = $e(this).parent('li'); if (li.hasClass('close')) { li.removeClass('close'); } else { li.addClass('close'); } });"></span>
                </div>
            </div>
            {@else}
            <div class="center string">已删除</div>
            {@/if}
        </td>
        <td><div class="date">${f.AddTime}</div></td>
        <td>
            <div class="tool" onmouseover="tableTool.over(this);" onmouseout="tableTool.out(this);">
                <p class="name">操作</p>
                <div class="tool-menu">
                    <ul>
                        <li>
                            <a href="javascript:void(0);" onclick="frm.update({ title: '修改客户', id: '${f.Id}', formId: 'CustomerFormTemplate', action: 'update', completed: top.custom.updateCompleted, completes: ['Province', 'City', 'Area'], callback: null, width: 700, height: 420 });">修改</a>
                        </li>
                        <li>
                            <a href="CustomerDetail.aspx?customerId=${f.Id}">详情</a>
                        </li>
                    </ul>
                </div>
            </div>
        </td>
    </tr>
    {@/each}
</script>

<script type="text/javascript">
    function loadData() {
        $e("#pageBody").loadPage("bodyListTemplate", "PageBarList", "<Condition></Condition><SortField>Name</SortField><SortDirect>DESC</SortDirect>", "", 20);
    }
    $e(function () {
        loadData();
    });
</script>
